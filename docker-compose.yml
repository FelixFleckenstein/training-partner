services:
    training-partner:
        image: build ./src/
        restart: always
        ports:
            - 8111:8000
        env_file:
            - ./app.env
        volumes:
            - './media/:/usr/src/app/media/'
        depends_on:
            db:
                condition: service_healthy

    db:
        image: mariadb
        restart: always
        ports:
            - 3307:3306
        env_file:
            - ./db.env
        volumes:
            - './mariadb/:/var/lib/mysql/'
        healthcheck:
            test: ["CMD", "mysqladmin", "ping", "--silent"]